
# what it is?

fulfil SUID & sudo demerits

Q. suppose we want `nano` to set like every user can read file as root with it but can't write. Can we do this with the help of sudo or SUID?
Ans. **NO**

so with capabilities, we can define special permission like just read as root or whatever


# Find capabilities

```
getcap -r / 2>/dev/null
/usr/sbin/getcap -r / 2>/dev/null
```

![[Pasted image 20240510234556.png]]

ignore default like we do for `sudo -l`


# cap_setuid

means set uid to whatever user we want and then run that particular program

like in our case `vim` is set with `cap_setuid`

go to GTFObins, LOL!

![[Pasted image 20240510234958.png]]

generally give full path

and try py and py3 because sometimes python or python3 either one is available

![[Pasted image 20240510235103.png]]


# Add capability to a file/Read capability priv esc

```
setcap CAP_DAC_READ_SEARCH=+ep /home/user/cat
```

![[Pasted image 20240510235300.png]]


