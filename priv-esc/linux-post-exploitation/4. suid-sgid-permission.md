
- SUID means that file or program will run which their owner
- Like `/bin/ping` have suid permission by root so if even normal user will run ping then it will run as root


![[Pasted image 20240510231822.png]]

Most commonly whenever we get root by SUID, we will be same user. we just get root for that effective program that's why euid is different

# SUID vs SGID

just owner difference
# Find SUID files

```
find / -type f -perm -4000 2>/dev/null

			OR

find / -type f -perm -u=s 2>/dev/null
```

# Exploit via SUID

### command intended functionalities

like if cat is set with **SUID** then you can read any file with cat!
means cat will run as root no matter what

just like that sed is set with SUID then we can replace file content with it


Oh common, this is sooooo basic!

### Shell Escaping

basically GTFObins

like `gcc` is not made to take shell but with GTFObins we can get shell


### Path Variable Injection

![[Pasted image 20240510232840.png]]

Suppose we get custom file and we check it's content

![[Pasted image 20240510232857.png]]

We noticed that it is starting apache2 with the help of service path

Now what we can do is,
> We can add new PATH in system with `service` name and add that in first place so whenever that custom file run, which have SUID set, service file in our PATH execute and we get shell

#### it's like unquoted service path in windows

![[Pasted image 20240510232512.png]]

```
echo $PATH

printenv (to get all env variables)

PATH=/home/user:$PATH (this will add /home/user in first place at PATH)
```


### Shared Object Overtake